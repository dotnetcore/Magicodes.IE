<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Magicodes.IE | English </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Magicodes.IE | English ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<img align="right" src="res/logo.jpg" width="300">
<h1 id="magicodesie--english">Magicodes.IE | <a href="README.md">English</a></h1>
<p><a href="https://github.com/dotnetcore"><img src="https://img.shields.io/badge/member%20project%20of-NCC-9e20c9.svg" alt="Member project of .NET Core Community"></a>
<a href="https://www.nuget.org/packages/Magicodes.IE.Core"><img src="https://img.shields.io/nuget/v/Magicodes.IE.Core.svg?style=flat-square" alt="nuget"></a>
<a href="https://dev.azure.com/xinlaiopencode/Magicodes.IE/_build/latest?definitionId=4&amp;branchName=master"><img src="https://dev.azure.com/xinlaiopencode/Magicodes.IE/_apis/build/status/dotnetcore.Magicodes.IE?branchName=master" alt="Build Status"></a>
<a href="https://www.nuget.org/stats/packages/Magicodes.IE.Core?groupby=Version"><img src="https://img.shields.io/nuget/dt/Magicodes.IE.Core.svg?style=flat-square" alt="stats"></a>
<a href="https://github.com/dotnetcore/Magicodes.IE/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License"></a></p>
<p><a href="https://starchart.cc/dotnetcore/Magicodes.IE"><img src="https://starchart.cc/dotnetcore/Magicodes.IE.svg" alt="Stargazers over time"></a></p>
<p><strong>最近主要精力都在CodeSpirit，由于业余精力极其有限，Magicodes.IE仅作间歇性维护。</strong></p>
<p><strong>地址（优先更新Gitee）：</strong><a href="https://gitee.com/magicodes/code-spirit">CodeSpirit（码灵）</a></p>
<p><strong>简介：<strong>CodeSpirit（码灵）是一款革命性的全栈低代码开发框架，通过智能代码生成引擎与AI深度协同，实现</strong>后端驱动式全栈开发范式</strong>。基于.NET 9技术栈构建，将具备企业级技术深度与云原生扩展能力，提供从界面生成、业务逻辑编排到系统运维的全生命周期支持。</p>
<p><strong>让全栈开发回归工程本质</strong></p>
<ul>
<li><strong>后端驱动式开发范式 · 企业级开放架构 · AI增强工程闭环</strong></li>
</ul>
<p><img src="https://img.shields.io/azure-devops/tests/xinlaiopencode/Magicodes.IE/4/master" alt="Azure DevOps tests (master)">
<img src="https://img.shields.io/azure-devops/coverage/xinlaiopencode/Magicodes.IE/4/master" alt="Azure DevOps coverage (branch)">
<a href="https://opencollective.com/magicodes"><img src="https://opencollective.com/magicodes/all/badge.svg?label=financial+contributors" alt="Financial Contributors on Open Collective"></a></p>
<h2 id="目录">目录</h2>
<ol>
<li><a href="#%E6%A6%82%E8%BF%B0">概述</a></li>
<li><a href="#%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA">自动构建</a></li>
<li><a href="#NuGet%E5%8C%85">Nuget包</a></li>
<li><a href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">注意事项</a></li>
<li><a href="#%E6%95%99%E7%A8%8B">教程</a></li>
<li><a href="#%E7%89%B9%E7%82%B9">特点</a></li>
<li><a href="https://github.com/dotnetcore/Magicodes.IE/issues?q=label%3Aquestion">FAQ</a></li>
<li><a href="#%E8%81%94%E7%B3%BB%E6%88%91%E4%BB%AC">联系我们</a></li>
<li><a href="RELEASE.html">更新历史</a></li>
<li><a href="#%E5%8F%8B%E6%83%85%E8%B5%9E%E5%8A%A9">友情赞助</a></li>
</ol>
<h2 id="概述">概述</h2>
<p>导入导出通用库，支持Dto导入导出、模板导出、花式导出以及动态导出，支持Excel、Csv、Word、Pdf和Html。</p>
<ul>
<li>Github：<a href="https://github.com/dotnetcore/Magicodes.IE">https://github.com/dotnetcore/Magicodes.IE</a></li>
<li>码云（手动同步，不维护）：<a href="https://gitee.com/magicodes/Magicodes.IE">https://gitee.com/magicodes/Magicodes.IE</a></li>
</ul>
<p><strong><img src="./docs/Magicodes.IE.png" alt="总体说明"></strong></p>
<h2 id="功能清单">功能清单</h2>
<ul>
<li>[ ] Excel
<ul>
<li>[ ] 导入
<ul>
<li>[x] Dto导入
<ul>
<li>[x] 导入配置
<ul>
<li>[x] 指定Sheet名称(获取指定Sheet名称)，为空则自动获取第一个</li>
<li>[x] 指定Sheet下标</li>
<li>[x] 截止读取的列数（从1开始，如果已设置，则将支持空行以及特殊列）</li>
<li>[x] 是否标注错误（默认为true）</li>
<li>[x] Sheet顶部导入描述</li>
<li>[x] Sheet顶部导入描述高度(换行可能无法自动设定高度,默认为Excel的默认行高)</li>
<li>[x] 是否仅导出错误数据</li>
<li>[x] 表头位置</li>
<li>[x] 最大允许导入的行数（默认没有限制）</li>
<li>[x] 导入结果筛选器</li>
<li>[x] 导入列头筛选器</li>
<li>[x] 是否禁用所有筛选器</li>
<li>[x] 是否忽略列的大小写</li>
</ul>
</li>
<li>[x] 列配置
<ul>
<li>[x] 列名</li>
<li>[x] 批注</li>
<li>[x] 作者</li>
<li>[x] 自动过滤空格，默认启用</li>
<li>[x] 处理所有的空格，包括中间空格</li>
<li>[x] 格式化（仅用于模板生成）</li>
<li>[x] 列索引，如果为0则自动计算</li>
<li>[x] 是否忽略</li>
</ul>
</li>
<li>[x] 导入验证
<ul>
<li>[x] DataAnnotations（MaxLength、Required...）</li>
<li>[x] 是否允许重复</li>
</ul>
</li>
<li>[x] 值映射
<ul>
<li>[x] bool</li>
<li>[x] 枚举</li>
</ul>
</li>
<li>[x] 筛选器
<ul>
<li>[x] 结果筛选器</li>
<li>[x] 列头筛选器</li>
</ul>
</li>
<li>[x] 特殊数据列导入
<ul>
<li>[x] 图片导入
<ul>
<li>[x] 导入为Base64</li>
<li>[x] 导入到临时目录</li>
<li>[x] 导入到指定目录</li>
</ul>
</li>
</ul>
</li>
<li>[x] 合并行导入</li>
<li>[x] 错误处理
<ul>
<li>[x] 模板校验错误</li>
<li>[x] 数据验证错误</li>
<li>[x] 异常</li>
<li>[x] 导入Excel文件的错误标注</li>
</ul>
</li>
<li>[x] 生成导入模板
<ul>
<li>[x] 数据验证提示</li>
<li>[x] 必填项标注</li>
<li>[x] 数据下拉项生成（仅枚举）</li>
<li>[x] 生成批注</li>
<li>[x] Excel内置数据验证，并支持自定义提示（默认未开启）
<ul>
<li>[x] MaxLengthAttribute</li>
<li>[x] MinLengthAttribute</li>
<li>[x] StringLengthAttribute</li>
<li>[x] RangeAttribute</li>
</ul>
</li>
</ul>
</li>
<li>[x] 乱序导入（无需按列顺序导入）</li>
<li>[x] <strong>多Sheet导入</strong></li>
</ul>
</li>
<li>[ ] 动态导入（<strong>Magicodes.IE.Stash</strong>）</li>
</ul>
</li>
<li>[ ] 导出</li>
</ul>
</li>
</ul>
<h2 id="自动构建">自动构建</h2>
<ul>
<li>Build Status：<a href="https://dev.azure.com/xinlaiopencode/Magicodes.IE/_build/latest?definitionId=4&amp;branchName=master"><img src="https://dev.azure.com/xinlaiopencode/Magicodes.IE/_apis/build/status/dotnetcore.Magicodes.IE?branchName=master" alt="Build Status"></a></li>
<li>Azure DevOps coverage (master):  <img src="https://img.shields.io/azure-devops/coverage/xinlaiopencode/Magicodes.IE/4/master" alt="Azure DevOps coverage (branch)"></li>
<li>Azure DevOps tests (master):  <img src="https://img.shields.io/azure-devops/tests/xinlaiopencode/Magicodes.IE/4/master" alt="Azure DevOps tests (master)"></li>
</ul>
<p>具体见：<a href="https://dev.azure.com/xinlaiopencode/Magicodes.IE/_build?definitionId=4&amp;_a=summary">https://dev.azure.com/xinlaiopencode/Magicodes.IE/_build?definitionId=4&amp;_a=summary</a></p>
<h2 id="nuget包">NuGet包</h2>
<h4 id="稳定版推荐">稳定版（推荐）</h4>
<table>
<thead>
<tr>
<th><strong>名称</strong></th>
<th style="text-align: left;"><strong>NuGet</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Magicodes.IE.Core</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Core"><img src="https://buildstats.info/nuget/Magicodes.IE.Core" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Excel</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Excel"><img src="https://buildstats.info/nuget/Magicodes.IE.Excel" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Excel.NPOI</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Excel.NPOI"><img src="https://buildstats.info/nuget/Magicodes.IE.Excel.NPOI" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Excel.AspNetCore</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Excel.AspNetCore"><img src="https://buildstats.info/nuget/Magicodes.IE.Excel.AspNetCore" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Pdf</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Pdf"><img src="https://buildstats.info/nuget/Magicodes.IE.Pdf" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Word</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Word"><img src="https://buildstats.info/nuget/Magicodes.IE.Word" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Html</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Html"><img src="https://buildstats.info/nuget/Magicodes.IE.Html" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Csv</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Csv"><img src="https://buildstats.info/nuget/Magicodes.IE.Csv" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.AspNetCore</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.AspNetCore"><img src="https://buildstats.info/nuget/Magicodes.IE.AspNetCore" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.EPPlus</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.EPPlus"><img src="https://buildstats.info/nuget/Magicodes.IE.EPPlus" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Excel.Abp</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Excel.Abp"><img src="https://buildstats.info/nuget/Magicodes.IE.Excel.Abp" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Csv.Abp</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Csv.Abp"><img src="https://buildstats.info/nuget/Magicodes.IE.Csv.Abp" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Html.Abp</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Html.Abp"><img src="https://buildstats.info/nuget/Magicodes.IE.Html.Abp" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Pdf.Abp</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Pdf.Abp"><img src="https://buildstats.info/nuget/Magicodes.IE.Pdf.Abp" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Word.Abp</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Word.Abp"><img src="https://buildstats.info/nuget/Magicodes.IE.Word.Abp" alt="NuGet"></a></strong></td>
</tr>
<tr>
<td><strong>Magicodes.IE.Stash</strong></td>
<td style="text-align: left;"><strong><a href="https://www.nuget.org/packages/Magicodes.IE.Stash"><img src="https://buildstats.info/nuget/Magicodes.IE.Stash" alt="NuGet"></a></strong></td>
</tr>
</tbody>
</table>
<h2 id="注意事项"><strong>注意事项</strong></h2>
<ul>
<li><strong>Excel导入不支持“.xls”文件，即不支持Excel97-2003。</strong></li>
<li><strong>如需在Docker中使用，请参阅文档中的《Docker中使用》一节。</strong></li>
<li><strong>相关功能均已编写单元测试，在使用的过程中可以参考单元测试。</strong></li>
</ul>
<h2 id="教程"><strong>教程</strong></h2>
<ol>
<li><strong><a href="docs/1.%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E4%B9%8B%E5%AF%BC%E5%85%A5%E5%AD%A6%E7%94%9F%E6%95%B0%E6%8D%AE.md" title="1.基础教程之导入学生数据">基础教程之导入学生数据</a>  （<a href="https://docs.xin-lai.com/2019/11/26/%E7%BB%84%E4%BB%B6/Magicodes.IE/1.%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E4%B9%8B%E5%AF%BC%E5%85%A5%E5%AD%A6%E7%94%9F%E6%95%B0%E6%8D%AE/">点此访问国内文档</a>）</strong></li>
<li><strong><a href="docs/2.%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E4%B9%8B%E5%AF%BC%E5%87%BAExcel.md" title="2.基础教程之导出Excel">基础教程之导出Excel</a>  <a href="https://docs.xin-lai.com/2020/02/19/%E7%BB%84%E4%BB%B6/Magicodes.IE/2.Magicodes.IE%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E4%B9%8B%E5%AF%BC%E5%87%BAExcel/">（点此访问国内文档）</a></strong></li>
<li><strong><a href="docs/3.%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E4%B9%8B%E5%AF%BC%E5%87%BAPdf%E6%94%B6%E6%8D%AE.md" title="3.基础教程之导出Pdf收据">基础教程之导出Pdf收据</a></strong> <a href="https://docs.xin-lai.com/2020/02/25/%E7%BB%84%E4%BB%B6/Magicodes.IE/3.Magicodes.IE%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E4%B9%8B%E5%AF%BC%E5%87%BAPdf/"><strong>(点此访问国内文档)</strong></a></li>
<li><strong><a href="docs/4.%E5%9C%A8Docker%E4%B8%AD%E4%BD%BF%E7%94%A8.md" title="4.在Docker中使用">在Docker中使用</a></strong></li>
<li><strong><a href="docs/5.%E5%8A%A8%E6%80%81%E5%AF%BC%E5%87%BA.md" title="5.动态导出">动态导出</a></strong></li>
<li><strong><a href="docs/6.%E5%A4%9ASheet%E5%AF%BC%E5%85%A5.md" title="6.多Sheet导入">多Sheet导入</a></strong></li>
<li><strong><a href="docs/7.Csv%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA.md" title="7.Csv导入导出">Csv导入导出</a></strong></li>
<li><strong><a href="docs/8.Excel%E5%9B%BE%E7%89%87%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA.md" title="8.Excel图片导入导出">Excel图片导入导出</a></strong> <a href="https://docs.xin-lai.com/2020/03/16/%E7%BB%84%E4%BB%B6/Magicodes.IE/%E4%BD%BF%E7%94%A8Magicodes.IE.Excel%E5%AE%8C%E6%88%90Excel%E5%9B%BE%E7%89%87%E7%9A%84%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA/"><strong>(点此访问国内文档)</strong></a></li>
<li><strong><a href="docs/9.Excel%E6%A8%A1%E6%9D%BF%E5%AF%BC%E5%87%BA%E4%B9%8B%E5%AF%BC%E5%87%BA%E6%95%99%E6%9D%90%E8%AE%A2%E8%B4%AD%E8%A1%A8.md" title="9.Excel模板导出之导出教材订购表">Excel模板导出之导出教材订购表</a>（<a href="https://docs.xin-lai.com/2020/01/08/%E7%BB%84%E4%BB%B6/Magicodes.IE/7.Excel%E6%A8%A1%E6%9D%BF%E5%AF%BC%E5%87%BA%E4%B9%8B%E5%AF%BC%E5%87%BA%E6%95%99%E6%9D%90%E8%AE%A2%E8%B4%AD%E8%A1%A8/">点此访问国内文档</a>）</strong></li>
<li><strong><a href="https://docs.xin-lai.com/2020/09/21/%E7%BB%84%E4%BB%B6/Magicodes.IE/Magicodes.IE%E4%B9%8B%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E7%AD%9B%E9%80%89%E5%99%A8/">进阶篇之导入导出筛选器</a></strong></li>
<li><strong><a href="https://docs.xin-lai.com/2020/09/28/%E7%BB%84%E4%BB%B6/Magicodes.IE/Magicodes.IE%E4%B9%8B%E8%8A%B1%E5%BC%8F%E5%AF%BC%E5%87%BA/">Magicodes.IE之花式导出</a></strong></li>
<li><strong><a href="docs/12.Magicodes.IE.AspNetCore%E4%B9%8B%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%A4%9A%E6%A0%BC%E5%BC%8F%E5%AF%BC%E5%87%BA.md">Magicodes.IE.AspNetCore之一行代码多格式导出</a></strong></li>
<li><strong><a href="docs/13.%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.md">性能测试</a></strong></li>
<li><a href="docs/Excel%E5%90%88%E5%B9%B6%E8%A1%8C%E5%AF%BC%E5%85%A5.md"><strong>Excel合并行导入</strong></a></li>
<li><a href="docs/Excel%E6%A8%A1%E6%9D%BF%E5%AF%BC%E5%87%BA%E4%B9%8B%E5%8A%A8%E6%80%81%E5%AF%BC%E5%87%BA.md"><strong>Excel模板导出之动态导出</strong></a></li>
<li><strong><a href="docs/AspNetCore%E4%B9%8B%E5%BF%AB%E9%80%9F%E5%AF%BC%E5%87%BAExcel.md">Magicodes.IE.Excel.AspNetCore之快速导出Excel（new）</a></strong></li>
</ol>
<p><strong>其他教程见下文或单元测试</strong></p>
<h2 id="特点">特点</h2>
<ul>
<li><strong>需配合相关导入导出的DTO模型使用，支持通过DTO以及相关特性控制导入导出。配置特性即可控制相关逻辑和显示结果，无需修改逻辑代码；</strong>
<strong><img src="res/%E5%AF%BC%E5%85%A5Dto.png" alt="" title="导入Dto"></strong></li>
<li><strong>支持各种筛选器，支持依赖注入，以便支持多语言、动态控制列展示等场景，具体使用见单元测试：</strong>
<ul>
<li><strong>导入列头筛选器【IImportHeaderFilter】（可动态指定导入列、导入的值映射关系）</strong></li>
<li><strong>导出列头筛选器【IImportHeaderFilter】（可动态控制导出列，支持动态导出（DataTable））</strong></li>
<li><strong>导出列头集合筛选器【IImportHeadersFilter】（可动态控制导出列，支持动态导出（DataTable））</strong></li>
<li><strong>导入结果筛选器【IImportResultFilter】（可修改标注文件）</strong></li>
</ul>
</li>
<li><strong>导出支持文本自定义过滤或处理；</strong></li>
<li><strong>导入支持中间空行自动跳过；</strong></li>
<li><strong>导入支持自动根据 DTO 生成导入模板,针对必填项将自动标注；</strong>
<strong><img src="res/%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E7%9A%84%E5%AF%BC%E5%85%A5%E6%A8%A1%E6%9D%BF.png" alt="" title="自动生成的导入模板"></strong></li>
<li><strong>导入支持数据下拉选择，目前仅支持枚举类型；</strong></li>
<li><strong>导入数据支持前后空格以及中间空格处理，允许指定列进行设置；</strong></li>
<li><strong>导入支持模板自动检查，数据自动校验，异常统一处理，并提供统一的错误封装，包含异常、模板错误和行数据错误；</strong>
<strong><img src="res/%E6%95%B0%E6%8D%AE%E9%94%99%E8%AF%AF%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E.png" alt="" title="数据错误"></strong></li>
<li><strong>支持导入表头位置设置，默认为1；</strong></li>
<li><strong>支持导入列乱序，无需按顺序一一对应；</strong></li>
<li><strong>支持导入指定列索引，默认自动识别；</strong></li>
<li><strong>导出Excel支持拆分Sheet，仅需设置特性【ExporterAttribute】的【MaxRowNumberOnASheet】的值，为0则不拆分。具体见单元测试；</strong></li>
<li><strong>支持将导入Excel进行错误标注；</strong>
<strong><img src="res/%E6%95%B0%E6%8D%AE%E9%94%99%E8%AF%AF.png" alt="" title="数据错误标注"></strong>
<strong><img src="res/%E5%A4%9A%E4%B8%AA%E9%94%99%E8%AF%AF.png" alt="" title="多个错误"></strong></li>
<li><strong>导入支持截止列设置，如未设置则默认遇到空格截止；</strong></li>
<li><strong>支持导出HTML、Word、Pdf，支持自定义导出模板；</strong>
<ul>
<li><strong>导出HTML</strong>
<strong><img src="res/%E5%AF%BC%E5%87%BAhtml.png" alt="" title="导出HTML"></strong></li>
<li><strong>导出Word</strong>
<strong><img src="res/%E5%AF%BC%E5%87%BAWord.png" alt="" title="导出Word"></strong></li>
<li><strong>导出Pdf，支持设置，具体见更新日志</strong>
<strong><img src="res/%E5%AF%BC%E5%87%BAPdf.png" alt="" title="导出Pdf"></strong></li>
<li><strong>导出收据</strong>
<strong><img src="res/%E5%AF%BC%E5%87%BA%E6%94%B6%E6%8D%AE.png" alt="" title="导出收据.png"></strong></li>
</ul>
</li>
<li><strong>导入支持重复验证；</strong>
<strong><img src="res/%E9%87%8D%E5%A4%8D%E9%94%99%E8%AF%AF.png" alt="" title="重复错误.png"></strong></li>
<li><strong>支持单个数据模板导出，常用于导出收据、凭据等业务</strong></li>
<li><strong>支持动态列导出（基于DataTable），并且超过100W将自动拆分Sheet。（感谢张善友老师（<a href="https://github.com/xin-lai/Magicodes.IE/pull/8">https://github.com/xin-lai/Magicodes.IE/pull/8</a> ））</strong></li>
<li><strong>支持 dynamic/ExpandoObject 动态列导出</strong></li>
</ul>
<pre><code class="lang-csharp">        [Fact(DisplayName = &quot;DTO导出支持动态类型&quot;)]
        public async Task ExportAsByteArraySupportDynamicType_Test()
        {
            IExporter exporter = new ExcelExporter();

            var filePath = GetTestFilePath($&quot;{nameof(ExportAsByteArraySupportDynamicType_Test)}.xlsx&quot;);

            DeleteFile(filePath);

            var source = GenFu.GenFu.ListOf&lt;ExportTestDataWithAttrs&gt;();
            string fields = &quot;text,number,name&quot;;
            var shapedData = source.ShapeData(fields) as ICollection&lt;ExpandoObject&gt;;

            var result = await exporter.ExportAsByteArray&lt;ExpandoObject&gt;(shapedData);
            result.ShouldNotBeNull();
            result.Length.ShouldBeGreaterThan(0);
            File.WriteAllBytes(filePath, result);
            File.Exists(filePath).ShouldBeTrue();
        }
</code></pre>
<ul>
<li><strong>支持值映射，支持通过“ValueMappingAttribute”特性设置值映射关系，目前仅可用于枚举和Bool类型，支持导入导出。</strong></li>
</ul>
<pre><code class="lang-csharp">        /// &lt;summary&gt;
        ///     性别
        /// &lt;/summary&gt;
        [ImporterHeader(Name = &quot;性别&quot;)]
        [Required(ErrorMessage = &quot;性别不能为空&quot;)]
        [ValueMapping(text: &quot;男&quot;, 0)]
        [ValueMapping(text: &quot;女&quot;, 1)]
        public Genders Gender { get; set; }
</code></pre>
<ul>
<li><strong>也可以继承“ValueMappingsBaseAttribute”特性基类实现值映射关系，目前仅可用于枚举和Bool类型，支持导入导出。</strong></li>
</ul>
<pre><code class="lang-csharp">        [AttributeUsage(AttributeTargets.Property, AllowMultiple = true)]
        public class GenderLocalAttribute : ValueMappingsBaseAttribute
        {
            public override Dictionary&lt;string, object&gt; GetMappings(PropertyInfo propertyInfo)
            {
                var res= new Dictionary&lt;string, object&gt;();
                res.Add(&quot;男&quot;,0);
                res.Add(&quot;女&quot;,1);
                return res;
            }
        }


        /// &lt;summary&gt;
        ///     性别
        /// &lt;/summary&gt;
        [ImporterHeader(Name = &quot;性别&quot;)]
        [Required(ErrorMessage = &quot;性别不能为空&quot;)]
        [GenderLocal]
        public Genders Gender { get; set; }
</code></pre>
<ul>
<li><p><strong>支持枚举和Bool类型的导入数据验证项的生成，以及相关数据转换</strong></p>
<ul>
<li><p><strong>枚举默认情况下会自动获取枚举的描述、显示名、名称和值生成数据项</strong></p>
<pre><code class="lang-csharp">  	/// &lt;summary&gt;
  	/// 学生状态 正常、流失、休学、勤工俭学、顶岗实习、毕业、参军
  	/// &lt;/summary&gt;
  	public enum StudentStatus
  	{
  		/// &lt;summary&gt;
  		/// 正常
  		/// &lt;/summary&gt;
  		[Display(Name = &quot;正常&quot;)]
  		Normal = 0,

  		/// &lt;summary&gt;
  		/// 流失
  		/// &lt;/summary&gt;
  		[Description(&quot;流水&quot;)]
  		PupilsAway = 1,

  		/// &lt;summary&gt;
  		/// 休学
  		/// &lt;/summary&gt;
  		[Display(Name = &quot;休学&quot;)]
  		Suspension = 2,

  		/// &lt;summary&gt;
  		/// 勤工俭学
  		/// &lt;/summary&gt;
  		[Display(Name = &quot;勤工俭学&quot;)]
  		WorkStudy = 3,

  		/// &lt;summary&gt;
  		/// 顶岗实习
  		/// &lt;/summary&gt;
  		[Display(Name = &quot;顶岗实习&quot;)]
  		PostPractice = 4,

  		/// &lt;summary&gt;
  		/// 毕业
  		/// &lt;/summary&gt;
  		[Display(Name = &quot;毕业&quot;)]
  		Graduation = 5,

  		/// &lt;summary&gt;
  		/// 参军
  		/// &lt;/summary&gt;
  		[Display(Name = &quot;参军&quot;)]
  		JoinTheArmy = 6,
  	}
</code></pre>
<p><strong><img src="res/enum.png" alt="" title="枚举转数据映射序列"></strong></p>
</li>
<li><p><strong>bool类型默认会生成“是”和“否”的数据项</strong></p>
</li>
<li><p><strong>如果已设置自定义值映射，则不会生成默认选项</strong></p>
</li>
</ul>
</li>
<li><p><strong>支持excel多Sheet导入；</strong>
<strong><img src="res/multipleSheet.png" alt="" title="枚举转数据映射序列"></strong></p>
</li>
<li><p><strong>支持Excel模板导出，JSON动态导出，并且支持图片渲染</strong>
<strong><img src="res/ExcelTplExport.png" alt="" title="Excel模板导出"></strong></p>
<p>渲染语法如下所示：</p>
<pre><code>  {{Company}}  //单元格渲染
  {{Table&gt;&gt;BookInfos|RowNo}} //表格渲染开始语法
  {{Remark|&gt;&gt;Table}}//表格渲染结束语法
  {{Image::ImageUrl?Width=50&amp;Height=120&amp;Alt=404}} //图片渲染
  {{Image::ImageUrl?w=50&amp;h=120&amp;Alt=404}} //图片渲染
  {{Image::ImageUrl?Alt=404}} //图片渲染
  {{Formula::AVERAGE?params=G4:G6}}  //公式渲染
  {{Formula::SUM?params=G4:G6&amp;G4}}   //公式渲染
</code></pre>
<p>后续将支持自定义管道。</p>
</li>
<li><p><strong>支持Excel导入模板生成标注</strong>
<img src="res/ImportLabel.png" alt="" title="Excel导入标注"></p>
</li>
<li><p><strong>支持Excel图片导入导出</strong></p>
<ul>
<li>图片导入
<ul>
<li>导入为Base64</li>
<li>导入到临时目录</li>
<li>导入到指定目录</li>
</ul>
</li>
<li>图片导出
<ul>
<li>将文件路径导出为图片</li>
<li>将网络路径导出为图片</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>支持多个实体导出多个Sheet</strong></p>
</li>
<li><p><strong>支持使用System.ComponentModel.DataAnnotations命名空间下的部分特性来控制导入导出</strong>  <a href="https://github.com/dotnetcore/Magicodes.IE/issues/63">#63</a></p>
</li>
<li><p><strong>支持在ASP.NET Core Web API 中使用自定义格式化程序导出Excel、Pdf、Csv等内容，具体见教程</strong> <a href="https://github.com/dotnetcore/Magicodes.IE/issues/64">#64</a></p>
</li>
<li><p><strong>支持分栏、分sheet、追加rows导出</strong></p>
</li>
</ul>
<pre><code class="lang-csharp">exporter.Append(list1).SeparateByColumn().Append(list2).ExportAppendData(filePath);
</code></pre>
<p>具体见上面教程《Magicodes.IE之花式导出》</p>
<ul>
<li><strong>支持单元格导出宽度设置</strong></li>
</ul>
<pre><code class="lang-csharp">[ExporterHeader(Width = 100)]
public DateTime Time3 { get; set; }
</code></pre>
<ul>
<li><p><strong>Excel导出支持HeaderRowIndex，在ExcelExporterAttribute导出特性类中添加HeaderRowIndex属性，方便导出时去指定从第一行开始导出。</strong></p>
</li>
<li><p><strong>Excel生成导入模板支持内置数据验证</strong></p>
</li>
</ul>
<p>对于内置数据验证的支持可通过IsInterValidation属性开启，并且需要注意的是仅支持MaxLengthAttribute、 MinLengthAttribute、 StringLengthAttribute、 RangeAttribute支持对内置数据验证的开启操作。
<img src="res/dataval1.png" alt="" title="Excel验证">
<img src="res/dataval2.png" alt="" title="Excel验证">
支持对输入提示的展示操作：
<img src="res/dataval3.png" alt="" title="Excel验证"></p>
<ul>
<li><p><strong>Excel导入支持合并行数据</strong> <a href="https://github.com/dotnetcore/Magicodes.IE/issues/239">#239</a></p>
<p><img src="res/image-20210306105147319.png" alt="合并行导入文件"></p>
</li>
<li><p>添加对Abp模块的包装，具体见<a href="https://github.com/dotnetcore/Magicodes.IE/issues/318">#318</a>。</p>
</li>
</ul>
<h2 id="联系我们"><strong>联系我们</strong></h2>
<blockquote>
<h5 id="订阅号"><strong>订阅号</strong></h5>
</blockquote>
<p><strong>关注“麦扣聊技术”订阅号可以获得最新文章、教程、文档，并且加入微信生态群：</strong></p>
<table>
<tr>
<td>
<img align="left" src="res/wechat.jpg" width="300">
</td>
<td>
<img align="right" src="res/IE_WeChat.png" width="300">
</td>
</tr>
</table>
> ##### **文档官网&官方博客**
<ul>
<li><strong>文档官网：<a href="https://docs.xin-lai.com/">https://docs.xin-lai.com/</a></strong></li>
<li><strong>博客：<a href="http://www.cnblogs.com/codelove/">http://www.cnblogs.com/codelove/</a></strong></li>
</ul>
<h3 id="code-contributors">Code Contributors</h3>
<p><a href="https://github.com/dotnetcore/Magicodes.IE/graphs/contributors"><img src="https://opencollective.com/magicodes/contributors.svg?width=890&button=false"></a></p>
<h3 id="financial-contributors">Financial Contributors</h3>
<p>Become a financial contributor and help us sustain our community. [<a href="https://opencollective.com/magicodes/contribute">Contribute</a>]</p>
<h4 id="individuals">Individuals</h4>
<p><a href="https://opencollective.com/magicodes"><img src="https://opencollective.com/magicodes/individuals.svg?width=890"></a></p>
<h4 id="organizations">Organizations</h4>
<p>Support this project with your organization. Your logo will show up here with a link to your website. [<a href="https://opencollective.com/magicodes/contribute">Contribute</a>]</p>
<p><a href="https://opencollective.com/magicodes/organization/0/website"><img src="https://opencollective.com/magicodes/organization/0/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/1/website"><img src="https://opencollective.com/magicodes/organization/1/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/2/website"><img src="https://opencollective.com/magicodes/organization/2/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/3/website"><img src="https://opencollective.com/magicodes/organization/3/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/4/website"><img src="https://opencollective.com/magicodes/organization/4/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/5/website"><img src="https://opencollective.com/magicodes/organization/5/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/6/website"><img src="https://opencollective.com/magicodes/organization/6/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/7/website"><img src="https://opencollective.com/magicodes/organization/7/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/8/website"><img src="https://opencollective.com/magicodes/organization/8/avatar.svg"></a>
<a href="https://opencollective.com/magicodes/organization/9/website"><img src="https://opencollective.com/magicodes/organization/9/avatar.svg"></a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/dotnetcore/Magicodes.IE/blob/master/README.zh-CN.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
