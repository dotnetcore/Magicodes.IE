<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Release Log </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Release Log ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="release-log">Release Log</h1>

<h2 id="276">2.7.6</h2>
<p><strong>2025.05.14</strong></p>
<ul>
<li>修复若干问题，具体见PR及Commit记录</li>
</ul>
<h2 id="2750">2.7.5.0</h2>
<p><strong>2024.01.03</strong></p>
<ul>
<li>发布Magicodes.IE.Stash，具体见<a href="https://github.com/dotnetcore/Magicodes.IE/pull/498">https://github.com/dotnetcore/Magicodes.IE/pull/498</a>及<a href="https://github.com/dotnetcore/Magicodes.IE/tree/master/src/Stash/Magicodes.IE.Stash">https://github.com/dotnetcore/Magicodes.IE/tree/master/src/Stash/Magicodes.IE.Stash</a></li>
<li>增加导入Stream时的回调委托参数<a href="https://github.com/dotnetcore/Magicodes.IE/commit/e9a2a1b3b493fea90379b0ee519b7bbb42011122">https://github.com/dotnetcore/Magicodes.IE/commit/e9a2a1b3b493fea90379b0ee519b7bbb42011122</a></li>
<li>增加ValueMappingsBase值映射特性基类，方便从外部(如：Abp框架)继承实现枚举、bool类型的多语言显示<a href="https://github.com/dotnetcore/Magicodes.IE/pull/544">https://github.com/dotnetcore/Magicodes.IE/pull/544</a></li>
</ul>
<h2 id="2744">2.7.4.4</h2>
<p><strong>2023.04.22</strong></p>
<ul>
<li>修复获取导入错误文件流时，因批注行导致的无表头的问题</li>
</ul>
<h2 id="2743">2.7.4.3</h2>
<p><strong>2023.03.16</strong></p>
<ul>
<li>优化列名中不包含FieldErrors的key触发的异常信息</li>
<li>Excel模板导出，图片格式支持base64</li>
</ul>
<h2 id="2742">2.7.4.2</h2>
<p><strong>2023.01.04</strong></p>
<ul>
<li>重构表头排序</li>
</ul>
<h2 id="2741">2.7.4.1</h2>
<p><strong>2023.01.02</strong></p>
<ul>
<li>Excel导出去除Task.FromResult包装，增加异步操作</li>
<li>修改内部集合类，充分利用池化内存，降低内存分配</li>
</ul>
<h2 id="274">2.7.4</h2>
<p><strong>2022.12.30</strong></p>
<ul>
<li>Fix DateTime cell convert to Nullable<datetime>，见pr <a href="https://github.com/dotnetcore/Magicodes.IE/pull/475">#475</a>。</datetime></li>
</ul>
<h2 id="273">2.7.3</h2>
<p><strong>2022.12.27</strong></p>
<ul>
<li>更新Haukcode.WkHtmlToPdfDotNet到1.5.86</li>
<li>tagetFrameworks移除net461</li>
</ul>
<h2 id="272">2.7.2</h2>
<p><strong>2022.12.04</strong></p>
<ul>
<li>修复FontSize的Bug</li>
</ul>
<h2 id="271">2.7.1</h2>
<p><strong>2022.12.01</strong></p>
<ul>
<li>Magicodes.IE.EPPlus默认添加SkiaSharp.NativeAssets.Linux.NoDependencies包，以便于在Linux环境下使用</li>
<li>导入验证支持将错误数据通过Stream的方式返回，感谢sampsonye （见pr<a href="https://github.com/dotnetcore/Magicodes.IE/pull/466">#466</a>）</li>
</ul>
<h2 id="270">2.7.0</h2>
<p><strong>2022.11.07</strong></p>
<ul>
<li>添加SkiaSharp</li>
<li>移除SixLabors.Fonts</li>
<li>感谢linch90的大力支持（具体见pr<a href="https://github.com/dotnetcore/Magicodes.IE/pull/462">#462</a>）</li>
<li>部分方法改为虚方法</li>
</ul>
<h2 id="270-beta">2.7.0-beta</h2>
<p><strong>2022.10.27</strong></p>
<ul>
<li>使用SixLabors.ImageSharp替代System.Drawing，感谢linch90 （见pr<a href="https://github.com/dotnetcore/Magicodes.IE/pull/454">#454</a>）</li>
</ul>
<h2 id="269">2.6.9</h2>
<p><strong>2022.10.26</strong></p>
<ul>
<li>fix: 动态数据源导出到多个sheet的问题 （见<a href="https://github.com/dotnetcore/Magicodes.IE/issues/449">#449</a>）</li>
</ul>
<h2 id="268">2.6.8</h2>
<p><strong>2022.10.18</strong></p>
<ul>
<li>Excel模板导出添加API，以支持通过文件流模板：Task&lt;byte[]&gt; ExportBytesByTemplate<t>(T data, Stream templateStream)</t></li>
</ul>
<h2 id="267">2.6.7</h2>
<p><strong>2022.10.12</strong></p>
<ul>
<li>ExporterHeaderFilter支持修改列索引，以支持动态排序，需设置ExporterHeaderAttribute.ColumnIndex属性（注意不应修改Index属性），值范围为0~10000。设置错误会自动调整到相近的边界值。</li>
<li>提供ExporterHeadersFilter筛选器，以支持批量修改列头。</li>
<li>重构、优化列排序代码。</li>
</ul>
<h2 id="265-beta1">2.6.5-beta1</h2>
<p><strong>2022.07.17</strong></p>
<ul>
<li>【修复】如果为动态类型导出，如datatable/dynamic/proxy等，会将原始数据转成字符串。</li>
<li>fix: 修复没有正确释放Graphics对象的问题 （见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/401">#401</a>）</li>
<li>feat(module: excel): Export of the byte type Enum value is allowed （见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/367">#367</a>）</li>
<li>feat(module: excel): The export can be of Nullable Enum type （见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/398">#398</a>）</li>
<li>fix(module: Excel): Excel ParseData</li>
</ul>
<h2 id="264">2.6.4</h2>
<p><strong>2022.04.17</strong></p>
<ul>
<li><p>优化了ColumnIndex在生成模板时的实现，增加了ColumnIndex的单测（见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/385">#385</a>）。</p>
</li>
<li><p>添加了NPOI的独立扩展包——Magicodes.IE.Excel.NPOI，以便于后续给用户提供更多的支持。目前仅提供了 SaveToExcelWithXSSFWorkbook 扩展方法。</p>
</li>
<li><p>修复RequiredIfAttribute的Bug。</p>
</li>
<li><p>修复导出JPG图片在Linux环境下可能引起的无限循环的问题（见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/396">#396</a>）。</p>
</li>
<li><p>Excel图片导入时，图片列支持为空。</p>
</li>
<li><p>更新CsvHelper到最新版本，并修改相关代码。</p>
</li>
</ul>
<h2 id="263">2.6.3</h2>
<p><strong>2022.03.06</strong></p>
<ul>
<li>完善筛选器注册机制，在指定了特性ImportHeaderFilter、ExporterHeaderFilter等值后，筛选器将匹配对于的类型（见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/384">#384</a>），如不指定则作为全局筛选器。如下述代码，注入了多个同类型的筛选器，通过指定了ImportHeaderFilter限制了此Dto仅使用ImportHeaderFilterB：</li>
</ul>
<pre><code class="lang-csharp">    builder.Services.AddTransient&lt;IImportHeaderFilter, ImportHeaderFilterA&gt;();
    builder.Services.AddTransient&lt;IImportHeaderFilter, ImportHeaderFilterB&gt;();
    builder.Services.AddTransient&lt;IImportHeaderFilter, ImportHeaderFilterC&gt;();

    [ExcelImporter(ImportHeaderFilter = typeof(ImportHeaderFilterB))]
    public class ImportExcelTemplateDto
    {
        [ImporterHeader(Name = &quot;TypeName&quot;)]
        public string? Name { get; set; }
    }
</code></pre>
<h2 id="262">2.6.2</h2>
<p><strong>2022.03.02</strong></p>
<ul>
<li>Excel导入时增加回调函数，方便增加自定义验证（见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/369">#369</a>）：</li>
</ul>
<pre><code class="lang-csharp">        [Fact(DisplayName = &quot;导入结果回调函数测试&quot;)]
        public async Task ImportResultCallBack_Test()
        {
            var filePath = Path.Combine(Directory.GetCurrentDirectory(), &quot;TestFiles&quot;, &quot;Import&quot;, &quot;缴费流水导入模板.xlsx&quot;);
            var import = await Importer.Import&lt;ImportPaymentLogDto&gt;(filePath, (importResult) =&gt;
            {
                int rowNum = 2;//首行数据对应Excel中的行号
                foreach (var importPaymentLogDto in importResult.Data)
                {
                    if (importPaymentLogDto.Amount &gt; 5000)
                    {
                        var dataRowError = new DataRowErrorInfo();
                        dataRowError.RowIndex = rowNum;
                        dataRowError.FieldErrors.Add(&quot;Amount&quot;, &quot;金额不能大于5000&quot;);
                        importResult.RowErrors.Add(dataRowError);
                    }
                    rowNum++;
                }
                return importResult;
            });
            import.ShouldNotBeNull();
            import.HasError.ShouldBeTrue();
            import.RowErrors.ShouldContain(p =&gt; p.RowIndex == 3 &amp;&amp; p.FieldErrors.ContainsKey(&quot;金额不能大于5000&quot;));
            import.Exception.ShouldBeNull();
            import.Data.Count.ShouldBe(20);
        }
</code></pre>
<ul>
<li><p>优化获取DisplayName的逻辑（见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/372">#372</a>）</p>
</li>
<li><p>导出CSV支持ColumnIndex（见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/381">#381</a>）</p>
</li>
<li><p>优化Pdf导出逻辑，统一各平台导出代码</p>
</li>
</ul>
<h2 id="261">2.6.1</h2>
<ul>
<li>修复内存未及时回收</li>
</ul>
<h2 id="260">2.6.0</h2>
<p><strong>2021.11.28</strong></p>
<ul>
<li><p>添加两个动态验证特性（见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/359">#319 by Afonsof91</a>）：</p>
<ul>
<li>添加特性<code>DynamicStringLengthAttribute</code>,以便支持动态配置字符串长度验证。使用参考：</li>
</ul>
<pre><code class="lang-csharp">public class DynamicStringLengthImportDto
{
    [ImporterHeader(Name = &quot;名称&quot;)]
    [Required(ErrorMessage = &quot;名称不能为空&quot;)]
    [DynamicStringLength(typeof(DynamicStringLengthImportDtoConsts), nameof(DynamicStringLengthImportDtoConsts.MaxNameLength), ErrorMessage = &quot;名称字数不能超过{1}&quot;)]
    public string Name { get; set; }
}

public static class DynamicStringLengthImportDtoConsts
{
    public static int MaxNameLength { get; set; } = 3;
}
</code></pre>
<ul>
<li>添加特性<code>RequiredIfAttribute</code>，以支持动态开启必填验证。使用参考：</li>
</ul>
<pre><code class="lang-csharp">public class RequiredIfAttributeImportDto
{
    [ImporterHeader(Name = &quot;名称是否必填&quot;)]
    [Required(ErrorMessage = &quot;名称是否必填不能为空&quot;)]
    [ValueMapping(&quot;是&quot;, true)]
    [ValueMapping(&quot;否&quot;, false)]
    public bool IsNameRequired { get; set; }

    [ImporterHeader(Name = &quot;名称&quot;)]
    [RequiredIf(&quot;IsNameRequired&quot;, &quot;True&quot;, ErrorMessage = &quot;名称不能为空&quot;)]
    [MaxLength(10, ErrorMessage = &quot;名称字数超出最大值：10&quot;)]
    public string Name { get; set; }
}
</code></pre>
</li>
<li><p>CSV添加对分隔符的配置，具体见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/319">#319 by Afonsof91</a></p>
</li>
<li><p>Excel导入添加对<code>TimeSpan</code>类型的支持，使用参考<code>TimeSpan_Test</code></p>
</li>
<li><p>初步添加对.NET6的适配</p>
</li>
</ul>
<h2 id="2563">2.5.6.3</h2>
<p><strong>2021.10.23</strong></p>
<ul>
<li>导出日期格式化支持<code>DateTimeOffset</code>类型，具体见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/349">#349</a>，感谢<a href="https://github.com/YaChengMu">YaChengMu</a></li>
<li>修改Magicodes.IE.EPPlus的包依赖PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/351">#351</a></li>
</ul>
<h2 id="2562">2.5.6.2</h2>
<p><strong>2021.10.13</strong></p>
<ul>
<li>支持自定义列字体颜色，具体见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/342">#342</a>，感谢<a href="https://github.com/xiangxiren">xiangxiren</a></li>
<li>修复日期格式化的问题，具体见PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/344">#344</a>，感谢<a href="https://github.com/ccccccmd">ccccccmd</a></li>
</ul>
<h2 id="2561">2.5.6.1</h2>
<p><strong>2021.10.06</strong></p>
<ul>
<li>修复 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/377">#337</a>，bool?类型导出的映射问题</li>
</ul>
<h2 id="2560">2.5.6.0</h2>
<p><strong>2021.10.05</strong></p>
<ul>
<li>合并Magicodes.EPPlus到Magicodes.IE，修复所有单元测试并修复部分Bug</li>
</ul>
<h2 id="2554">2.5.5.4</h2>
<p><strong>2021.09.02</strong></p>
<ul>
<li>修复可为空枚举导入时的验证问题<a href="https://github.com/dotnetcore/Magicodes.IE/issues/322">#322</a>。</li>
</ul>
<h2 id="2553">2.5.5.3</h2>
<p><strong>2021.08.27</strong></p>
<ul>
<li>修复Append方式导出多个sheet时，发生“Tablename is not unique”错误，具体见<a href="https://github.com/dotnetcore/Magicodes.IE/issues/299">#299</a>。</li>
</ul>
<h2 id="2552">2.5.5.2</h2>
<p><strong>2021.08.24</strong></p>
<ul>
<li>添加对Abp模块的包装，具体见<a href="https://github.com/dotnetcore/Magicodes.IE/issues/318">#318</a>342。</li>
</ul>
<h2 id="2551">2.5.5.1</h2>
<p><strong>2021.08.07</strong></p>
<ul>
<li>为了简化ASP.NET Core下的Excel导出，对Excel导出进行了进一步的封装</li>
<li>添加<code>Magicodes.IE.Excel.AspNetCore</code>工程，添加<code>XlsxFileResult</code>的Action Result，支持泛型集合、Bytes数组、Steam直接导出</li>
<li>修改部分命名和命名空间</li>
</ul>
<h2 id="2549">2.5.4.9</h2>
<p><strong>2021.07.23</strong></p>
<ul>
<li>修复Excel合并行导入在存在空的合并单元格时可能的数据读取错误<a href="https://github.com/dotnetcore/Magicodes.IE/issues/305">#305</a></li>
</ul>
<h2 id="2548">2.5.4.8</h2>
<p><strong>2021.07.15</strong></p>
<ul>
<li>Magicodes.EPPlus回退到4.6.6，以修复格式错乱的问题</li>
<li>修复Excel仅导出错误数据时的Bug<a href="https://github.com/dotnetcore/Magicodes.IE/pull/302">#302</a></li>
<li>完善多语言<a href="https://github.com/dotnetcore/Magicodes.IE/pull/298">#298</a>，以及完善单元测试</li>
</ul>
<h2 id="2546">2.5.4.6</h2>
<p><strong>2021.07.04</strong></p>
<ul>
<li>模板导出支持一行多个表格<a href="https://github.com/dotnetcore/Magicodes.IE/issues/296">#296</a></li>
</ul>
<h2 id="2545">2.5.4.5</h2>
<p><strong>2021.06.29</strong></p>
<ul>
<li>合并PR<a href="https://github.com/dotnetcore/Magicodes.IE/pull/295">#295</a>,完善模板导出类型定义的问题</li>
</ul>
<h2 id="2544">2.5.4.4</h2>
<p><strong>2021.06.25</strong></p>
<ul>
<li>Fix only first [ColumnIndex] is valid exception<a href="https://github.com/dotnetcore/Magicodes.IE/issues/289">#289</a></li>
</ul>
<h2 id="2543">2.5.4.3</h2>
<p><strong>2021.06.18</strong></p>
<ul>
<li>Update ImportTestColumnIndex_Test</li>
<li>Magicodes.EPPlus was upgraded to 4.6.7<a href="https://github.com/dotnetcore/Magicodes.IE/issues/285">#285</a></li>
</ul>
<h2 id="2542">2.5.4.2</h2>
<p><strong>2021.06.05</strong></p>
<ul>
<li>Fix ImporterHeader-&gt;ColumnIndex</li>
<li>Utilize RecyclableMemoryStream instead of &quot;new MemoryStream&quot; all over<a href="https://github.com/dotnetcore/Magicodes.IE/issues/282">#282</a></li>
</ul>
<h2 id="2541">2.5.4.1</h2>
<p><strong>2021.06.05</strong></p>
<ul>
<li>EXCEL模板导出支持XOffset和YOffset<a href="https://github.com/dotnetcore/Magicodes.IE/issues/280">#280</a></li>
<li>EXCEL修复ValueMapping</li>
<li>Core工程多语言配置</li>
<li>EXCEL优化时间导出</li>
</ul>
<h2 id="2540">2.5.4.0</h2>
<p><strong>2021.06.01</strong></p>
<ul>
<li>EXCEL支持自动换行属性<a href="https://github.com/dotnetcore/Magicodes.IE/issues/278">#278</a></li>
<li>EXCEL支持隐藏列属性<a href="https://github.com/dotnetcore/Magicodes.IE/issues/273">#273</a></li>
<li>EXCEL优化时间优化</li>
</ul>
<h2 id="2539">2.5.3.9</h2>
<p><strong>2021.05.26</strong></p>
<ul>
<li>修复ValueMappingAttribute<a href="https://github.com/dotnetcore/Magicodes.IE/issues/272">#272</a></li>
</ul>
<h2 id="2538">2.5.3.8</h2>
<p><strong>2021.05.10</strong></p>
<ul>
<li>Excel模板导出功能，将单行复制改为多行复制</li>
<li>PDF导出内存优化</li>
</ul>
<h2 id="2537">2.5.3.7</h2>
<p><strong>2021.04.23</strong></p>
<ul>
<li>修复导入模板生成，格式错误<a href="https://github.com/dotnetcore/Magicodes.IE/issues/261">#261</a>
例如：</li>
</ul>
<h2 id="2536">2.5.3.6</h2>
<p><strong>2021.04.18</strong></p>
<ul>
<li>支持对导入模板生成，预设值单元格格式<a href="https://github.com/dotnetcore/Magicodes.IE/issues/253">#253</a>
例如：</li>
</ul>
<pre><code>[ImporterHeader(Name = &quot;序号&quot;, Format =&quot;@&quot;)]
</code></pre>
<ul>
<li>单元格图片导出支持偏移设置<a href="https://github.com/dotnetcore/Magicodes.IE/issues/250">#250</a>
例如：</li>
</ul>
<pre><code>**YOffset**：垂直偏移（可进行移动图片）
**XOffset**：水平偏移（可进行移动图片）
</code></pre>
<ul>
<li>支持多sheet导入SheetIndex的支持<a href="https://github.com/dotnetcore/Magicodes.IE/issues/254">#254</a>
例如：</li>
</ul>
<pre><code>[ExcelImporter(SheetIndex = 2)]
</code></pre>
<h2 id="2535">2.5.3.5</h2>
<p><strong>2021.04.13</strong></p>
<ul>
<li>Excel导入支持列头忽略大小写导入（全局配置：IsIgnoreColumnCase）</li>
</ul>
<h2 id="2534">2.5.3.4</h2>
<p><strong>2021.04.06</strong></p>
<ul>
<li>Excel导入修复枚举值不在范围时的错误提示</li>
</ul>
<h2 id="2533">2.5.3.3</h2>
<p><strong>2021.04.03</strong></p>
<ul>
<li>Excel导入逻辑移除5万行的限制，默认不限制导入数量</li>
</ul>
<h2 id="2532">2.5.3.2</h2>
<p><strong>2021.03.30</strong></p>
<ul>
<li>Excel修复OutputBussinessErrorData扩展方法</li>
<li>多Sheet导入对Stream的支持</li>
</ul>
<h2 id="2531">2.5.3.1</h2>
<p><strong>2021.03.12</strong></p>
<ul>
<li>Excel模板导出支持使用Dictionary、ExpandoObject完成动态导出</li>
<li>优化模板导出逻辑</li>
</ul>
<h2 id="253">2.5.3</h2>
<p><strong>2021.03.08</strong></p>
<ul>
<li>Excel模板导出支持使用JSON对象完成动态导出 <a href="https://gitee.com/magicodes/Magicodes.IE/issues/I398DI">#I398DI</a></li>
</ul>
<h2 id="252">2.5.2</h2>
<p><strong>2021.03.05</strong></p>
<ul>
<li>Excel导入支持合并行数据 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/239">#239</a></li>
</ul>
<h2 id="2518">2.5.1.8</h2>
<p><strong>2021.02.23</strong></p>
<ul>
<li>Input string was not in a correct format.<a href="https://github.com/dotnetcore/Magicodes.IE/issues/241">#241</a></li>
<li>使用Stream方式导入xlsx，rowErrors里的rowIndex位置不对<a href="https://github.com/dotnetcore/Magicodes.IE/issues/236">#236</a></li>
</ul>
<h2 id="2517">2.5.1.7</h2>
<p><strong>2021.02.20</strong></p>
<ul>
<li>Excel支持Base64导出 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/219">#219</a></li>
<li>修复 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/214">#214</a></li>
</ul>
<h2 id="2516">2.5.1.6</h2>
<p><strong>2021.01.31</strong></p>
<ul>
<li>部分重构模板导出</li>
<li>Excel模板导出语法解析加强 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/211">#211</a></li>
<li>修复当表格下面存在变量时，无法渲染的Bug</li>
</ul>
<h2 id="2515">2.5.1.5</h2>
<p><strong>2021.01.29</strong></p>
<ul>
<li>移除模板导出时的控制台日志输出</li>
</ul>
<h2 id="2514">2.5.1.4</h2>
<p><strong>2021.01.09</strong></p>
<ul>
<li>修复Excel导出列头索引与内容排序不一致问题及单测  <a href="https://github.com/dotnetcore/Magicodes.IE/issues/226">#226</a></li>
</ul>
<h2 id="2513">2.5.1.3</h2>
<p><strong>2021.01.02</strong></p>
<ul>
<li>Add PDF support for paper size</li>
<li>Add PDF support for margins <a href="https://github.com/dotnetcore/Magicodes.IE/issues/223">#223</a></li>
</ul>
<h2 id="251">2.5.1</h2>
<p><strong>2020.12.21</strong></p>
<ul>
<li>导出支持使用ColumnIndex指定导出顺序，以导出时在某些情况下顺序不一致的问题（Export supports the use of ColumnIndex to specify the export order, so that the order is inconsistent in some cases when exporting）  <a href="https://github.com/dotnetcore/Magicodes.IE/issues/179">#179</a></li>
</ul>
<h2 id="250">2.5.0</h2>
<p><strong>2020.12.03</strong></p>
<ul>
<li>Excel导出支持HeaderRowIndex <a href="https://github.com/dotnetcore/Magicodes.IE/issues/164">#164</a></li>
<li>增加Excel枚举导出对DescriptionAttribute的支持 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/168">#168</a></li>
<li>Excel生成导入模板支持内置数据验证<a href="https://github.com/dotnetcore/Magicodes.IE/issues/167">#167</a>
<ul>
<li>支持数据验证
<ul>
<li>支持MaxLengthAttribute、MinLengthAttribute、StringLengthAttribute、RangeAttribute</li>
</ul>
</li>
<li>支持输入提示
To fix The Mapping Values of The total length of a Data Validation list always exceed 255 characters (# 196) (<a href="https://github.com/dotnetcore/Magicodes.IE/issues/196">https://github.com/dotnetcore/Magicodes.IE/issues/196</a>)</li>
</ul>
</li>
<li>Excel export List data type errors, and formatting issues.<a href="https://github.com/dotnetcore/Magicodes.IE/issues/191">#191</a> [193] (<a href="https://github.com/dotnetcore/Magicodes.IE/issues/193">https://github.com/dotnetcore/Magicodes.IE/issues/193</a>)</li>
<li>导入Excel对Enum类型匹配值映射时，忽略值前后空格</li>
<li>fix MappingValues The total length of a DataValidation list cannot exceed 255 characters <a href="https://github.com/dotnetcore/Magicodes.IE/issues/196">#196</a></li>
<li>Excel导出List数据类型存在错误，以及格式化问题。 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/191">#191</a> <a href="https://github.com/dotnetcore/Magicodes.IE/issues/193">#193</a></li>
<li>The ColumnIndex property does not appear to be valid in Excel import  <a href="https://github.com/dotnetcore/Magicodes.IE/issues/198">#198</a></li>
<li>TableStyle修改为枚举类型</li>
</ul>
<h2 id="250-beta6">2.5.0-beta6</h2>
<p><strong>2020.11.26</strong></p>
<ul>
<li>The ColumnIndex property does not appear to be valid in Excel import  <a href="https://github.com/dotnetcore/Magicodes.IE/issues/198">#198</a></li>
</ul>
<h2 id="250-beta5">2.5.0-beta5</h2>
<p><strong>2020.11.25</strong></p>
<ul>
<li>fix MappingValues The total length of a DataValidation list cannot exceed 255 characters <a href="https://github.com/dotnetcore/Magicodes.IE/issues/196">#196</a></li>
<li>Excel导出List数据类型存在错误，以及格式化问题。 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/191">#191</a> <a href="https://github.com/dotnetcore/Magicodes.IE/issues/193">#193</a></li>
</ul>
<h2 id="250-beta4">2.5.0-beta4</h2>
<p><strong>2020.11.20</strong>
To fix The Mapping Values of The total length of a Data Validation list always exceed 255 characters (# 196) (<a href="https://github.com/dotnetcore/Magicodes.IE/issues/196">https://github.com/dotnetcore/Magicodes.IE/issues/196</a>)</p>
<ul>
<li>Excel export List data type errors, and formatting issues. <a href="https://github.com/dotnetcore/Magicodes.IE/issues/191">#191</a> [193] (<a href="https://github.com/dotnetcore/Magicodes.IE/issues/193">https://github.com/dotnetcore/Magicodes.IE/issues/193</a>)</li>
<li>导入Excel对Enum类型匹配值映射时，忽略值前后空格</li>
</ul>
<h2 id="250-beta3">2.5.0-beta3</h2>
<p><strong>2020.10.29</strong></p>
<ul>
<li>Excel生成导入模板支持内置数据验证<a href="https://github.com/dotnetcore/Magicodes.IE/issues/167">#167</a>
<ul>
<li>支持数据验证
<ul>
<li>支持MaxLengthAttribute、MinLengthAttribute、StringLengthAttribute、RangeAttribute</li>
</ul>
</li>
<li>支持输入提示</li>
</ul>
</li>
</ul>
<h2 id="250-beta2">2.5.0-beta2</h2>
<p><strong>2020.10.20</strong></p>
<ul>
<li>Excel导出支持HeaderRowIndex <a href="https://github.com/dotnetcore/Magicodes.IE/issues/164">#164</a></li>
<li>增加Excel枚举导出对DescriptionAttribute的支持 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/168">#168</a></li>
</ul>
<h2 id="240">2.4.0</h2>
<p><strong>2020.10.01</strong></p>
<ul>
<li>支持单元格导出宽度设置 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/129">#129</a></li>
<li>Excel导出支持对Enum的ValueMapping设置 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/106">#106</a></li>
<li>Excel导出支持对bool类型的ValueMapping设置 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/16">#16</a></li>
<li><a href="https://github.com/dotnetcore/Magicodes.IE/issues/152">#152</a> 筛选器支持依赖注入</li>
</ul>
<pre><code class="lang-csharp">   public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)
   {
       AppDependencyResolver.Init(app.ApplicationServices);
       //all other code
   }
</code></pre>
<ul>
<li>#151 导出添加AutoFitMaxRows，超过指定行数则不启用AutoFit</li>
<li>添加全局IsDisableAllFilter属性，以通过特性禁用所有筛选器</li>
<li><a href="https://github.com/dotnetcore/Magicodes.IE/issues/142">#142</a> 【修复】根据模板列表高度的设置，统一设置渲染高度</li>
<li><a href="https://github.com/dotnetcore/Magicodes.IE/issues/157">#157</a>【修复】对低版本框架的兼容</li>
<li>Excel导入对图片获取算法的优化</li>
</ul>
<h2 id="240-beta4">2.4.0-beta4</h2>
<p><strong>2020.09.26</strong></p>
<ul>
<li><a href="https://github.com/dotnetcore/Magicodes.IE/issues/157">#157</a>【修复】对低版本框架的兼容</li>
</ul>
<h2 id="240-beta3">2.4.0-beta3</h2>
<p><strong>2020.09.24</strong></p>
<ul>
<li><a href="https://github.com/dotnetcore/Magicodes.IE/issues/142">#142</a> 【修复】根据模板列表高度的设置，统一设置渲染高度</li>
</ul>
<h2 id="240-beta2">2.4.0-beta2</h2>
<p><strong>2020.09.16</strong></p>
<ul>
<li><a href="https://github.com/dotnetcore/Magicodes.IE/issues/152">#152</a> 筛选器支持依赖注入</li>
</ul>
<pre><code class="lang-csharp">   public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)
   {
       AppDependencyResolver.Init(app.ApplicationServices);
       //all other code
   }
</code></pre>
<ul>
<li>#151 导出添加AutoFitMaxRows，超过指定行数则不启用AutoFit</li>
<li>添加全局IsDisableAllFilter属性，以通过特性禁用所有筛选器</li>
</ul>
<h2 id="240-beta1">2.4.0-beta1</h2>
<p><strong>2020.09.14</strong></p>
<ul>
<li>支持单元格导出宽度设置 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/129">#129</a></li>
<li>Excel导出支持对Enum的ValueMapping设置 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/106">#106</a></li>
<li>Excel导出支持对bool类型的ValueMapping设置 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/16">#16</a></li>
</ul>
<h2 id="230">2.3.0</h2>
<p><strong>2020.08.30</strong></p>
<h2 id="230-beta8">2.3.0-beta8</h2>
<p><strong>2020.08.22</strong></p>
<ul>
<li>修复基于文件流导入时的NULL异常，并完善单元测试 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/141">#141</a>**</li>
</ul>
<h2 id="230-beta7">2.3.0-beta7</h2>
<p><strong>2020.08.16</strong></p>
<ul>
<li>excel添加对ExpandoObject类型的支持 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/135">#135</a>**</li>
</ul>
<p><strong>2020.08.10</strong></p>
<ul>
<li><strong>【Nuget】版本更新到2.3.0-beta6</strong></li>
<li>多Sheet导入保存标注错误单元测试，并没出现多数据导入效验bug <a href="https://github.com/dotnetcore/Magicodes.IE/issues/108">#108</a></li>
<li>Excel多Sheet 导入模板生成 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/133">#133</a></li>
<li>修复Excel模板图片高度问题 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/131">#131</a></li>
</ul>
<p><strong>2020.08.04</strong></p>
<ul>
<li><strong>【Nuget】版本更新到2.3.0-beta5</strong></li>
<li><strong>在runtimes native包问题</strong></li>
<li><strong>对于跨平台native中 <code>COM Interop is not supported on this platform.</code>修复</strong> <a href="https://github.com/dotnetcore/Magicodes.IE/issues/130">#130</a></li>
</ul>
<p><strong>2020.07.14</strong></p>
<ul>
<li><strong>【Nuget】版本更新到2.3.0-beta4</strong></li>
</ul>
<p><strong>2020.07.13</strong></p>
<ul>
<li><strong>【Nuget】版本更新到2.3.0-beta3</strong></li>
<li><strong>【PDF导出】修复Linux下导出PDf 出错问题 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/125">#125</a></strong></li>
</ul>
<p><strong>2020.07.06</strong></p>
<ul>
<li><p><strong>【Nuget】版本更新到2.3.0-beta2</strong></p>
</li>
<li><p><strong>【Excel导出】导出业务错误数据支持直接返回错误数据的文件流字节</strong></p>
</li>
<li><p><strong>【Excel导出】对追加sheet实现同一个Model可自定义传入不同sheet名称</strong></p>
<ul>
<li>exporter.Append(list1,&quot;sheet1&quot;).SeparateBySheet().Append(list2).ExportAppendData(filePath);</li>
</ul>
</li>
<li><p><strong>【Nuget】针对于一些客户端不支持SemVer 2.0.0 进行采取兼容机制</strong></p>
</li>
</ul>
<p><strong>2020.06.22</strong></p>
<ul>
<li><p><strong>【Nuget】版本更新到2.3.0-beta1</strong></p>
</li>
<li><p><strong>【Excel导出】添加对Excel模板导出函数的支持</strong></p>
<pre><code>    - {{Formula::AVERAGE?params=G4:G6}}
    - {{Formula::SUM?params=G4:G6&amp;G4}}
</code></pre>
</li>
</ul>
<p><strong>2020.06.16</strong></p>
<ul>
<li><strong>【Nuget】版本更新到2.2.6</strong></li>
<li><strong>【HTML导出】添加对NETCore2.2模板引擎的支持</strong></li>
</ul>
<p><strong>2020.06.14</strong></p>
<ul>
<li><p><strong>【Nuget】版本更新到2.2.5</strong></p>
</li>
<li><p><strong>【Excel导出】增加分栏、分sheet、追加rows导出 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/74">#74</a></strong></p>
<pre><code>- exporter.Append(list1).SeparateByColumn().Append(list2).ExportAppendData(filePath);
- exporter.Append(list1).SeparateBySheet().Append(list2).ExportAppendData(filePath);
- exporter.Append(list1).SeparateByRow().AppendHeaders().Append(list2).ExportAppendData(filePath);
</code></pre>
</li>
<li><p><strong>[Excel导出】修复‘IsAllowRepeat＝true’ <a href="https://github.com/dotnetcore/Magicodes.IE/issues/107">#107</a></strong></p>
</li>
<li><p><strong>[Pdf导出】增加PDF扩展方法，支持通过以参数形式传递特性参数 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/104">#104</a></strong></p>
<pre><code>- Task&lt;byte[]&gt; ExportListBytesByTemplate&lt;T&gt;(ICollection＜T＞ data, PdfExporterAttribute pdfExporterAttribute,string temple);
- Task&lt;byte[]&gt; ExportBytesByTemplate＜T＞(T data, PdfExporterAttribute pdfExporterAttribute,string template);
</code></pre>
</li>
</ul>
<p><strong>2020.06.07</strong></p>
<ul>
<li><strong>【Nuget】版本更新到2.2.4</strong></li>
<li><strong>【Excel导入】增加<code>导入失败</code>仅返回错误行功能</strong></li>
<li><strong>【Excel导入】修复导入的空行标注位置偏移</strong></li>
<li><strong>【Excel导出】增加<code>SeparateByColumn</code>进行分割追加列</strong></li>
</ul>
<h4 id="20200531">2020.05.31</h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.3</strong></li>
<li><strong>【Excel导入】增加了stream Csv导入扩展方法</strong></li>
<li><strong>【Word导出】修复word文件字节导出错误</strong></li>
</ul>
<h4 id="20200524"><strong>2020.05.24</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.2</strong></li>
<li><strong>【Excel导入】增加了stream导入扩展方法</strong></li>
<li><strong>【Excel导出】增加了内容居中（单列居中、整表居中）</strong></li>
<li><strong>【导出】对一些中间件代码进行了修复及优化</strong></li>
</ul>
<h4 id="20200516"><strong>2020.05.16</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.1</strong></li>
<li><strong>【PDF导出】对模板引擎进行升级更新</strong></li>
</ul>
<h4 id="20200512"><strong>2020.05.12</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0</strong></li>
<li><strong>【Excel模板导出】支持导出字节</strong></li>
<li><strong>【文档】Magicodes.IE Csv导入导出</strong></li>
<li><strong>【Excel导入导出】修复标注的添加问题</strong></li>
<li><strong>【导出】ASP.NET Core Web API 中使用自定义格式化程序导出Excel、Pdf、Csv等内容</strong> <a href="https://github.com/dotnetcore/Magicodes.IE/issues/64">#64</a></li>
<li><strong>【导入导出】支持使用System.ComponentModel.DataAnnotations命名空间下的部分特性来控制导入导出</strong>  <a href="https://github.com/dotnetcore/Magicodes.IE/issues/63">#63</a></li>
</ul>
<h4 id="20200416"><strong>2020.04.16</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0-beta9</strong></li>
<li><strong>【Excel模板导出】修复只存在一列时的导出 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/73">#73</a></strong></li>
<li><strong>【Excel导入】支持返回表头和索引 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/76">#76</a></strong></li>
<li><strong>【Excel导入导入】<a href="https://github.com/dotnetcore/Magicodes.IE/issues/63">#63</a></strong>
<ul>
<li>支持使用System.ComponentModel.DataAnnotations命名空间下的部分特性来控制导入导出，比如
<ul>
<li>DisplayAttribute</li>
<li>DisplayFormatAttribute</li>
<li>DescriptionAttribute</li>
</ul>
</li>
<li>封装简单的易于使用的单一特性，例如
<ul>
<li>IEIgnoreAttribute（可作用于属性、枚举成员，可影响导入和导出）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="20200402"><strong>2020.04.02</strong></h4>
<ul>
<li><p><strong>【Nuget】版本更新到2.2.0-beta8</strong></p>
</li>
<li><p><strong>【Excel模板导出】支持图片 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/62">#62</a>，渲染语法如下所示：</strong></p>
</li>
</ul>
<pre><code> {{Image::ImageUrl?Width=50&amp;Height=120&amp;Alt=404}}
 {{Image::ImageUrl?w=50&amp;h=120&amp;Alt=404}}
 {{Image::ImageUrl?Alt=404}}
</code></pre>
<h4 id="20200329"><strong>2020.03.29</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0-beta7</strong></li>
<li><strong>【Excel模板导出】修复渲染问题 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/51">#51</a></strong></li>
</ul>
<h4 id="20200327"><strong>2020.03.27</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0-beta6</strong></li>
<li><strong>【Excel导入导出】修复.NET Core 2.2的包引用问题 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/68">#68</a></strong></li>
</ul>
<h4 id="20200326"><strong>2020.03.26</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0-beta4</strong></li>
<li><strong>【Excel多Sheet导出】修复<a href="https://github.com/dotnetcore/Magicodes.IE/issues/66">#66</a>，并添加单元测试</strong></li>
</ul>
<h4 id="20200325"><strong>2020.03.25</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0-beta3</strong></li>
<li><strong>【Excel导入】修复日期问题 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/68">#68</a></strong></li>
<li><strong>【Excel导出】添加ExcelOutputType设置，支持输出无格式的导出。<a href="https://github.com/dotnetcore/Magicodes.IE/issues/54">#54</a>可以使用此方式。</strong></li>
</ul>
<h4 id="20200319"><strong>2020.03.19</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0-beta2</strong></li>
<li><strong>【Excel导入】修复日期格式的导入Bug，支持DateTime和DateTimeOffset以及可为空类型，默认支持本地化时间格式（默认根据地区自动使用本地日期时间格式）</strong></li>
<li><strong>【Excel导入导出】添加单元测试ExportAndImportUseOneDto_Test，对使用同一个Dto导出并导入进行测试。Issue见 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/53">#53</a></strong></li>
</ul>
<h4 id="20200318"><strong>2020.03.18</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.2.0-beta1</strong></li>
<li><strong>【Excel导出】添加以下API:</strong></li>
</ul>
<pre><code class="lang-csharp">
        /// &lt;summary&gt;
        ///     追加集合到当前导出程序
        ///     append the collection to context
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;dataItems&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        ExcelExporter Append&lt;T&gt;(ICollection&lt;T&gt; dataItems) where T : class;

        /// &lt;summary&gt;
        ///     导出所有的追加数据
        ///     export excel after append all collectioins
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;fileName&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        Task&lt;ExportFileInfo&gt; ExportAppendData(string fileName);

        /// &lt;summary&gt;
        ///     导出所有的追加数据
        ///     export excel after append all collectioins
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;fileName&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        Task&lt;byte[]&gt; ExportAppendDataAsByteArray();

</code></pre>
<ul>
<li><strong>【Excel导出】支持多个实体导出多个Sheet</strong>，感谢@ccccccmd 的贡献 <a href="https://github.com/dotnetcore/Magicodes.IE/pull/52">#pr52</a> ，Issue见 <a href="https://github.com/dotnetcore/Magicodes.IE/issues/50">#50</a>。使用代码参考，具体见单元测试（ExportMutiCollection_Test）：</li>
</ul>
<pre><code class="lang-csharp">            var exporter = new ExcelExporter();
            var list1 = GenFu.GenFu.ListOf&lt;ExportTestDataWithAttrs&gt;();
            var list2 = GenFu.GenFu.ListOf&lt;ExportTestDataWithSplitSheet&gt;(30);
            var result = exporter.Append(list1).Append(list2).ExportAppendData(filePath);
</code></pre>
<h4 id="20200312"><strong>2020.03.12</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.1.4</strong></li>
<li><strong>【Excel导入】支持图片导入，见特性ImportImageFieldAttribute</strong>
<ul>
<li>导入为Base64</li>
<li>导入到临时目录</li>
<li>导入到指定目录</li>
</ul>
</li>
<li><strong>【Excel导出】支持图片导出，见特性ExportImageFieldAttribute</strong>
<ul>
<li>将文件路径导出为图片</li>
<li>将网络路径导出为图片</li>
</ul>
</li>
</ul>
<h4 id="20200306"><strong>2020.03.06</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.1.3</strong></li>
<li><strong>【Excel导入】修复GUID类型的问题。问题见（<a href="https://github.com/dotnetcore/Magicodes.IE/issues/44">https://github.com/dotnetcore/Magicodes.IE/issues/44</a>）。</strong></li>
</ul>
<h4 id="20200225"><strong>2020.02.25</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.1.2</strong></li>
<li><strong>【导入导出】已支持CSV</strong></li>
<li><strong>【文档】完善Pdf导出文档</strong></li>
</ul>
<h4 id="20200224"><strong>2020.02.24</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.1.1-beta</strong></li>
<li><strong>【导入】Excel导入支持导入标注，仅需设置ExcelImporterAttribute的ImportDescription属性，即会在顶部生成Excel导入说明</strong></li>
<li><strong>【重构】添加两个接口</strong>
<ul>
<li>IExcelExporter：继承自IExporter, IExportFileByTemplate，Excel特有的API将在此补充</li>
<li>IExcelImporter：继承自IImporter，Excel特有的API在此补充，例如“ImportMultipleSheet”、“ImportSameSheets”</li>
</ul>
</li>
<li><strong>【重构】增加实例依赖注入</strong></li>
<li><strong>【构建】完成代码覆盖率的DevOps的配置</strong></li>
</ul>
<h4 id="20200214"><strong>2020.02.14</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.1.0</strong></li>
<li><strong>【导出】PDF导出支持.NET 4.6.1，具体见单元测试</strong></li>
</ul>
<h4 id="20200213"><strong>2020.02.13</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.0.2</strong></li>
<li><strong>【导入】修复单列导入的Bug，单元测试“OneColumnImporter_Test”。问题见（<a href="https://github.com/dotnetcore/Magicodes.IE/issues/35">https://github.com/dotnetcore/Magicodes.IE/issues/35</a>）。</strong></li>
<li><strong>【导出】修复导出HTML、Pdf、Word时，模板在某些情况下编译报错的问题。</strong></li>
<li><strong>【导入】重写空行检查。</strong></li>
</ul>
<h4 id="20200211"><strong>2020.02.11</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.0.0</strong></li>
<li><strong>【导出】Excel模板导出修复多个Table渲染以及合并单元格渲染的问题，具体见单元测试“ExportByTemplate_Test1”。问题见（<a href="https://github.com/dotnetcore/Magicodes.IE/issues/34">https://github.com/dotnetcore/Magicodes.IE/issues/34</a>）。</strong></li>
<li><strong>【导出】完善模板导出的单元测试，针对导出结果添加渲染检查，确保所有单元格均已渲染。</strong></li>
</ul>
<h4 id="20200205"><strong>2020.02.05</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.0.0-beta4</strong></li>
<li><strong>【导入】支持列筛选器（需实现接口【IImportHeaderFilter】），可用于兼容多语言导入等场景，具体见单元测试【ImportHeaderFilter_Test】</strong></li>
<li><strong>【导入】支持传入标注文件路径，不传参则默认同目录&quot;_&quot;后缀保存</strong></li>
<li><strong>【导入】完善单元测试【ImportResultFilter_Test】</strong></li>
<li><strong>【其他】修改【ValueMappingAttribute】的命名空间为Magicodes.ExporterAndImporter.Core</strong></li>
</ul>
<h4 id="20200204"><strong>2020.02.04</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.0.0-beta2</strong></li>
<li><strong>【导入】支持导入结果筛选器——IImportResultFilter，可用于多语言场景的错误标注，具体使用见单元测试【ImportResultFilter_Test】</strong></li>
<li><strong>【其他】修改IExporterHeaderFilter的命名空间为Magicodes.ExporterAndImporter.Core.Filters</strong></li>
</ul>
<h4 id="20200118"><strong>2020.01.18</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到2.0.0-beta1</strong></li>
<li><strong>【导出】完全重构整个导出Excel模块并且重写大部分接口</strong></li>
<li><strong>【导出】支持列头筛选器——IExporterHeaderFilter，具体使用见单元测试</strong></li>
<li><strong>【导出】修复转换DataTable时支持为空类型</strong></li>
<li><strong>【导出】导出Excel支持拆分Sheet，仅需设置特性【ExporterAttribute】的【MaxRowNumberOnASheet】的值，为0则不拆分。具体见单元测试</strong></li>
<li><strong>【导出】修复导出结果无法筛选的问题。目前导出即为数据表</strong></li>
<li><strong>【导出】添加扩展方法ToExcelExportFileInfo</strong></li>
<li><strong>【导出】IExporter再添加两个动态DataTable导出方法，无需定义Dto即可动态导出数据，并且支持表头筛选器、Sheet拆分</strong></li>
</ul>
<pre><code class="lang-csharp">        /// &lt;summary&gt;
        ///     导出Excel
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;fileName&quot;&gt;文件名称&lt;/param&gt;
        /// &lt;param name=&quot;dataItems&quot;&gt;数据&lt;/param&gt;
        /// &lt;param name=&quot;exporterHeaderFilter&quot;&gt;表头筛选器&lt;/param&gt;
        /// &lt;param name=&quot;maxRowNumberOnASheet&quot;&gt;一个Sheet最大允许的行数，设置了之后将输出多个Sheet&lt;/param&gt;
        /// &lt;returns&gt;文件&lt;/returns&gt;
        Task&lt;ExportFileInfo&gt; Export(string fileName, DataTable dataItems, IExporterHeaderFilter exporterHeaderFilter = null, int maxRowNumberOnASheet = 1000000);

        /// &lt;summary&gt;
        ///     导出Excel
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;dataItems&quot;&gt;数据&lt;/param&gt;
        /// &lt;param name=&quot;exporterHeaderFilter&quot;&gt;表头筛选器&lt;/param&gt;
        /// &lt;param name=&quot;maxRowNumberOnASheet&quot;&gt;一个Sheet最大允许的行数，设置了之后将输出多个Sheet&lt;/param&gt;
        /// &lt;returns&gt;文件二进制数组&lt;/returns&gt;
        Task&lt;byte[]&gt; ExportAsByteArray(DataTable dataItems, IExporterHeaderFilter exporterHeaderFilter = null, int maxRowNumberOnASheet = 1000000);
</code></pre>
<h4 id="20200116"><strong>2020.01.16</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.25</strong></li>
<li><strong>【导出】修复没有定义导出特性会报错的情形，具体见单元测试“ExportTestDataWithoutExcelExporter_Test”。问题见（<a href="https://github.com/dotnetcore/Magicodes.IE/issues/21">https://github.com/dotnetcore/Magicodes.IE/issues/21</a>）。</strong></li>
</ul>
<h4 id="20200116-1"><strong>2020.01.16</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.24</strong></li>
<li><strong>【导出】修复日期格式默认导出数字的Bug，默认输出“yyyy-MM-dd”，可以通过设置“[ExporterHeader(DisplayName = &quot;日期2&quot;, Format = &quot;yyyy-MM-dd HH:mm:ss&quot;)]”来修改。问题见（<a href="https://github.com/dotnetcore/Magicodes.IE/issues/22">https://github.com/dotnetcore/Magicodes.IE/issues/22</a>）。</strong></li>
</ul>
<h4 id="20200114"><strong>2020.01.14</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.21</strong></li>
<li><strong>【导出】Excel模板导出修复数据项为Null报错的Bug。</strong></li>
</ul>
<h4 id="20200109"><strong>2020.01.09</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.20</strong></li>
<li><strong>【导出】Excel模板导出性能优化。5000条表格数据1秒内完成，具体见单元测试ExportByTemplate_Large_Test。</strong></li>
</ul>
<h4 id="20200108"><strong>2020.01.08</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.18</strong></li>
<li><strong>【导入】支持导入最大数量限制</strong>
<ul>
<li><strong>ImporterAttribute支持MaxCount设置，默认为50000</strong></li>
<li><strong>完成相关单元测试</strong></li>
</ul>
</li>
</ul>
<h4 id="20200107"><strong>2020.01.07</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.17</strong></li>
<li><strong>【重构】重构IExportFileByTemplate中的ExportByTemplate，将参数htmlTemplate改为template。以便支持Excel模板导出。</strong></li>
<li><strong>【导出】支持Excel模板导出并填写相关单元测试，如何使用见教程《Excel模板导出之导出教材订购表》</strong>
<ul>
<li><strong>支持单元格单个绑定</strong></li>
<li><strong>支持列表</strong></li>
</ul>
</li>
</ul>
<h4 id="20191217"><strong>2019.12.17</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.16</strong></li>
<li><strong>【导入】Excel导入支持多sheet导入，感谢tanyongzheng（<a href="https://github.com/dotnetcore/Magicodes.IE/pull/18">https://github.com/dotnetcore/Magicodes.IE/pull/18</a>）</strong></li>
</ul>
<h4 id="20191210"><strong>2019.12.10</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.15</strong></li>
<li><strong>【测试】单元测试添加多框架版本支持 (<a href="https://docs.xin-lai.com/2019/12/10/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/Magicodes.IE%E7%BC%96%E5%86%99%E5%A4%9A%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC%E6%94%AF%E6%8C%81%E5%92%8C%E6%89%A7%E8%A1%8C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">https://docs.xin-lai.com/2019/12/10/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/Magicodes.IE%E7%BC%96%E5%86%99%E5%A4%9A%E6%A1%86%E6%9E%B6%E7%89%88%E6%9C%AC%E6%94%AF%E6%8C%81%E5%92%8C%E6%89%A7%E8%A1%8C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/</a>)</strong></li>
<li><strong>【修复】修复部分.NET Framework 461下的问题</strong></li>
</ul>
<h4 id="20191206"><strong>2019.12.06</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.14</strong></li>
<li><strong>【重构】大量重构</strong>
<ul>
<li><strong>移除部分未使用的代码</strong></li>
<li><strong>将TemplateFileInfo重命名为ExportFileInfo</strong></li>
<li><strong>将IExporterByTemplate接口拆分为4个接口：IExportListFileByTemplate, IExportListStringByTemplate, IExportStringByTemplate, IExportFileByTemplate，并修改相关实现</strong></li>
<li><strong>重构ImportHelper部分代码</strong></li>
</ul>
</li>
<li><strong>【导入】修复导入Excel时表头设置的问题，已对此编写单元测试，见【产品信息导入】</strong></li>
<li><strong>【完善】编写ExportAsByteArray对于DataTable的单元测试，ExportWordFileByTemplate_Test</strong></li>
</ul>
<h4 id="20191125"><strong>2019.11.25</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.13</strong></li>
<li><strong>【导出】Pdf导出支持特性配置，详见单元测试【导出竖向排版收据】。目前主要支持以下设置：</strong>
<ul>
<li><strong>Orientation：排版方向（横排、竖排）</strong></li>
<li><strong>PaperKind：纸张类型，默认A4</strong></li>
<li><strong>IsEnablePagesCount：是否启用分页数</strong></li>
<li><strong>Encoding：编码设置，默认UTF8</strong></li>
<li><strong>IsWriteHtml：是否输出HTML模板，如果启用，则会输出.html后缀的对应的HTML文件，方便调错</strong></li>
<li><strong>HeaderSettings：头部设置，通常可以设置头部的分页内容和信息</strong></li>
<li><strong>FooterSettings：底部设置</strong></li>
</ul>
</li>
</ul>
<h4 id="20191124"><strong>2019.11.24</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.12</strong></li>
<li><strong>【导出】导出动态类支持超过100W数据时自动拆分Sheet（具体见PR：<a href="https://github.com/xin-lai/Magicodes.IE/pull/14">https://github.com/xin-lai/Magicodes.IE/pull/14</a>）</strong></li>
</ul>
<h4 id="20191120"><strong>2019.11.20</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.11</strong></li>
<li><strong>【导出】修复Datatable列的顺序和DTO的顺序不一致，导致数据放错列（具体见PR：<a href="https://github.com/xin-lai/Magicodes.IE/pull/13">https://github.com/xin-lai/Magicodes.IE/pull/13</a>）</strong></li>
</ul>
<h4 id="20191116"><strong>2019.11.16</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.10</strong></li>
<li><strong>【导出】修复Pdf导出在多线程下的问题</strong></li>
</ul>
<h4 id="20191113"><strong>2019.11.13</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.5</strong></li>
<li><strong>【导出】修复导出Pdf在某些情况下可能会导致内存报错的问题</strong></li>
<li><strong>【导出】添加批量导出收据单元测试示例，并添加大量数据样本进行测试</strong></li>
</ul>
<h4 id="2019115"><strong>2019.11.5</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.4</strong></li>
<li><strong>【导入】修复枚举类型的问题，并编写单元测试</strong></li>
<li><strong>【导入】增加值映射，支持通过“ValueMappingAttribute”特性设置值映射关系。用于生成导入模板的数据验证约束以及进行数据转换。</strong></li>
<li><strong>【导入】优化枚举和Bool类型的导入数据验证项的生成，以便于模板生成和数据转换</strong>
<ul>
<li><strong>枚举默认情况下会自动获取枚举的描述、显示名、名称和值生成数据项</strong></li>
<li><strong>bool类型默认会生成“是”和“否”的数据项</strong></li>
<li><strong>如果已设置自定义值映射，则不会生成默认选项</strong></li>
</ul>
</li>
<li><strong>【导入】支持枚举可为空类型</strong></li>
</ul>
<h4 id="20191030"><strong>2019.10.30</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.4.0</strong></li>
<li><strong>【导出】Excel导出支持动态列导出（基于DataTable），感谢张善友（https://github.com/xin-lai/Magicodes.IE/pull/8 ）</strong></li>
</ul>
<h4 id="20191022"><strong>2019.10.22</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.3.7</strong></li>
<li><strong>【导入】修复忽略列的验证问题</strong></li>
<li><strong>【导入】修正验证错误信息，一行仅允许存在一条数据</strong></li>
<li><strong>【导入】修复忽略列在某些情况下可能引发的异常</strong></li>
<li><strong>【导入】添加存在忽略列的导入情形下的单元测试</strong></li>
</ul>
<h4 id="20191021"><strong>2019.10.21</strong></h4>
<ul>
<li><strong>【Nuget】版本更新到1.3.4</strong></li>
<li><strong>【导入】支持设置忽略列，以便于在Dto定义数据列做处理或映射</strong></li>
</ul>
<h4 id="20191018"><strong>2019.10.18</strong></h4>
<ul>
<li><strong>【优化】优化.NET标准库2.1下集合转DataTable的性能</strong></li>
<li><strong>【重构】多处IList<t>修改为ICollection<t></t></t></strong></li>
<li><strong>【完善】补充部分单元测试</strong></li>
</ul>
<h4 id="20191012"><strong>2019.10.12</strong></h4>
<ul>
<li><strong>【重构】重构HTML、PDF导出等逻辑，并修改IExporterByTemplate为：</strong>
<ul>
<li><strong>Task<string> ExportListByTemplate<t>(IList<t> dataItems, string htmlTemplate = null) where T : class;</t></t></string></strong></li>
<li><strong>Task<string> ExportByTemplate<t>(T data, string htmlTemplate = null) where T : class;</t></string></strong></li>
</ul>
</li>
<li><strong>【示例】添加收据导出的单元测试示例</strong></li>
</ul>
<h4 id="2019928"><strong>2019.9.28</strong></h4>
<ul>
<li><strong>【导出】修改默认的导出HTML、Word、Pdf模板</strong></li>
<li><strong>【导入】添加截断行的单元测试，以测试中间空格和结尾空格</strong></li>
<li><strong>【导入】将【数据错误检测】和【导入】单元测试的Dto分开，确保全部单元测试通过</strong></li>
<li><strong>【文档】更新文档</strong></li>
</ul>
<h4 id="2019926"><strong>2019.9.26</strong></h4>
<ul>
<li><strong>【导出】支持导出Word、Pdf、HTML，支持自定义导出模板</strong></li>
<li><strong>【导出】添加相关导出的单元测试</strong></li>
<li><strong>【导入】支持重复验证，需设置ImporterHeader特性的IsAllowRepeat为false</strong></li>
</ul>
<h4 id="2019919"><strong>2019.9.19</strong></h4>
<ul>
<li><strong>【导入】支持截止列设置，如未设置则默认遇到空格截止</strong></li>
<li><strong>【导入】导入支持通过特性设置Sheet名称</strong></li>
</ul>
<h4 id="2019918"><strong>2019.9.18</strong></h4>
<ul>
<li><strong>【导入】重构导入模块</strong></li>
<li><strong>【导入】统一导入错误消息</strong>
<ul>
<li><strong>Exception ：导入异常信息</strong></li>
<li><strong>RowErrors ： 数据错误信息</strong></li>
<li><strong>TemplateErrors ：模板错误信息，支持错误分级</strong></li>
<li><strong>HasError : 是否存在错误（仅当出现异常并且错误等级为Error时返回true）</strong></li>
</ul>
</li>
<li><strong>【导入】基础类型必填自动识别，比如int、double等不可为空类型自动识别，无需额外设置Required</strong></li>
<li><strong>【导入】修改Excel模板的Sheet名称</strong></li>
<li><strong>【导入】支持导入表头位置设置，默认为1</strong></li>
<li><strong>【导入】支持列乱序（导入模板的列序号不再需要固定）</strong></li>
<li><strong>【导入】支持列索引设置</strong></li>
<li><strong>【导入】支持将导入的Excel进行错误标注，支持多个错误</strong></li>
<li><strong>【导入】加强对基础类型和可为空类型的支持</strong></li>
<li><strong>【EPPlus】由于EPPlus.Core已经不维护，将EPPlus的包从EPPlus.Core改为EPPlus，</strong></li>
</ul>
<h4 id="2019911"><strong>2019.9.11</strong></h4>
<ul>
<li><strong>【导入】导入支持自动去除前后空格，默认启用，可以针对列进行关闭，具体见AutoTrim设置</strong></li>
<li><strong>【导入】导入Dto的字段允许不设置ImporterHeader，支持通过DisplayAttribute特性获取列名</strong></li>
<li><strong>【导入】导入的Excel移除对Sheet名称的约束，默认获取第一个Sheet</strong></li>
<li><strong>【导入】导入增加对中间空格的处理支持，需设置FixAllSpace</strong></li>
<li><strong>【导入】导入完善对日期类型的支持</strong></li>
<li><strong>【导入】完善导入的单元测试</strong></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/dotnetcore/Magicodes.IE/blob/master/RELEASE.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
